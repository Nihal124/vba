Sub RunPythonScript()

    Dim objshell As Object
    Dim PythonScriptPath As String
    Dim cmd As String

    Set objshell = VBA.CreateObject("Wscript.Shell")

    ' Specify the path to your Python script
    PythonScriptPath = "C:\VS Code\Final_code_split_file_automation.py"

    ' Construct the command to open cmd.exe with a prompt for Y/N
    cmd = "cmd /k echo Do you want to run the Python script (Y/N)?" & _
          " & choice /n /c:YN /t 10 /d Y /m ""Y: Yes, N: No""" & _
          " & if errorlevel 2 exit" & _
          " & py.exe """ & PythonScriptPath & """"

    ' Execute the command
    On Error Resume Next
    Dim result As Integer
    result = objshell.Run(cmd, 1, True)

    If result = 0 Then
        MsgBox "Python script executed successfully."
    Else
        MsgBox "Error executing Python script. Error code: " & result
    End If

    ' Release the object
    Set objshell = Nothing

End Sub
