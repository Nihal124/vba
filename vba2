Sub RunPythonScriptWithUserPrompt()

    Dim objshell As Object
    Dim PythonScriptPath As String

    Set objshell = VBA.CreateObject("Wscript.Shell")

    ' Specify the path to your Python script
    PythonScriptPath = "C:\VS Code\Final_code_split_file_automation.py"

    ' Use the cmd.exe to run the Python script with py.exe
    Dim cmd As String
    cmd = "cmd /k echo off & set /p userResponse=Do you want to run the Python script? (y/n) & if /i !userResponse! == y (py.exe """ & PythonScriptPath & """) else (echo Python script execution canceled.)"

    ' Execute the command
    On Error Resume Next
    Dim result As Integer
    result = objshell.Run(cmd, 1, True)

    ' Release the object
    Set objshell = Nothing

End Sub
