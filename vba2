Sub RunPythonScript()

    Dim objshell As Object
    Dim PythonScriptPath As String

    Set objshell = VBA.CreateObject("Wscript.Shell")

    ' Specify the path to your Python script
    PythonScriptPath = "C:\VS Code\Final_code_split_file_automation.py"

    ' Use the cmd.exe to run the Python script with py.exe
    Dim cmd As String
    cmd = "cmd /k py.exe """ & PythonScriptPath & """"

    ' Execute the command
    On Error Resume Next
    Dim result As Integer
    result = objshell.Run(cmd, 1, False)

    If result = 0 Then
        MsgBox "Press 'y' and Enter to compile the Python script in the Command Prompt."
    Else
        MsgBox "Error executing Python script. Error code: " & result
    End If

    ' Release the object
    Set objshell = Nothing

    ' Prompt the user to press 'y' or 'n' in the Command Prompt
    Dim userInput As String
    userInput = InputBox("Enter 'y' to compile the Python script in the Command Prompt, or 'n' to cancel.", "User Input")

    If LCase(userInput) = "y" Then
        ' The user entered 'y', so the Python script will be compiled
        ' You can add additional logic here to handle the compilation
    Else
        ' The user entered 'n', so you can handle this case as needed
        MsgBox "Compilation canceled."
    End If

End Sub
