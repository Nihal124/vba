Sub RunPythonScriptWithPrompt()

    Dim objshell As Object
    Dim PythonScriptPath As String

    Set objshell = VBA.CreateObject("Wscript.Shell")

    ' Specify the path to your Python script
    PythonScriptPath = "C:\VS Code\Final_code_split_file_automation.py"

    ' Prompt the user for input
    Dim userResponse As String
    userResponse = InputBox("Do you want to run the Python script? (y/n)")

    If UCase(userResponse) = "Y" Then
        ' Use the cmd.exe to run the Python script with py.exe
        Dim cmd As String
        cmd = "cmd /k py.exe """ & PythonScriptPath & """"

        ' Execute the command
        On Error Resume Next
        Dim result As Integer
        result = objshell.Run(cmd, 1, True)

        If result = 0 Then
            MsgBox "Python script executed successfully."
        Else
            MsgBox "Error executing Python script. Error code: " & result
        End If
    Else
        MsgBox "Python script execution canceled."
    End If

    ' Release the object
    Set objshell = Nothing

End Sub
